## MySQL

1. SQL 的 select 执行顺序

   1. from：组装不同数据源的数据
   2. where：筛选
   3. group by：分组
   4. 聚合函数进行计算
   5. having 筛选分组
   6. 计算所有表达式
   7. select 字段
   8. order by 排序

2. SQL 聚合函数

   1. avg
   2. count
   3. max
   4. min
   5. sum
   6. group by

3. SQL 连接查询

   1. 左连接：左表为基准全部显示出来，右表与左表匹配的数据显示响应字段的数据
   2. 右连接：右表为基准全部显示出来，左表与右表匹配的数据显示响应字段的数据
   3. 全连接：先左连接，再右连接
   4. 内连接：显示表之间有连接匹配的所有行

4. SQL 注入

   1. 即执行类似：select * from user where name="zhagnsan" and "a"="a"
   2. 解决方式：使用 MyBatis 中的 #

5. MySQL 性能优化

   1. **只要一行数据时，使用 limit 1**；这样mysql数据库会在找到一条结果后停止搜索，而不是继续查询直到所有符合的记录查询完毕
   2. 选择正确的数据库引擎
      1. **MyISAM：适用于大量查询的应用，但不利于大量写的应用（任何update都会锁表）**
      2. **InnoDB：写操作的表现比较优秀，使用行锁，且支持事务**
   3. 用 not exists 代替 not in
      1. not in 不能使用索引
   4. **尽量不使用不利于索引的操作符：如 in、not in、is null、is not null、<、> 等**
   5. 尽量避免在列上做运算，这样会导致索引失效
      1. 如 `"select * from tb where year(time) > 2014" => "select * from tb where time>'2014-01-01'"`
   6. limit 基数比较大时，使用 between

6. 数据库引擎 innoDB 与 MyISAM

   1. **MyISAM: 默认存储引擎，特点是不支持事务、表锁、全文索引**
   2. **InnoDB：支持事务、行锁、支持外键**

7. **MySQL 事务：事务就是执行一组要么全部成功，要么全部失败的操作**

   1. **事务的特点：**

      1. **原子性：所有操作要么全部成功，要么全部失败；当有一个失败时，就回滚**
      2. **一致性：数据库总是从一个状态转到另一个状态（即第三步执行中系统崩溃，因事务未提交，前面的修改也不会保存到数据库）**
      3. **隔离性：事务间互相隔离，保证同一时间仅有一个事务访问同一数据**
      4. **持久性：事务完成后，该事务的操作将持久化到数据库**

   2. **事务的四种隔离级别：**

      1. | 隔离级别         | 名称     | 解释                                                         | 脏读 | 不可重复读 | 幻读 |
         | ---------------- | -------- | ------------------------------------------------------------ | ---- | ---------- | ---- |
         | Read uncommitted | 读未提交 | 事务可以读取其他事务未提交的数据                             | 是   | 是         | 是   |
         | Read committed   | 读已提交 | 事务提交之前所做的修改，其他事务不可见（SQLServer的默认隔离级别） | 否   | 是         | 是   |
         | Repeatable read  | 可重复读 | 保证同一事务中的多次查询结果是相同的（MySQL的默认隔离级别）  | 否   | 否         | 是   |
         | Serializable     | 串行化   | 保证读取范围内没有新的数据插入                               | 否   | 否         | 否   |

   3. **事务的 脏读、不可重复读、幻读**：

      1. 脏读：事务1修改了一条数据但未提交，事务2读取了该数据，此时事务1回滚后，事务2中的数据就是条脏读数据
      2. 不可重复读：事务1读取了一条数据但未提交，事务2读取了改数据并提交后，事务1再次读取改数据，两次查询不一样
      3. 幻读：事务1读取若干记录但未提交事务，事务2插入一条记录，此时事务1使用相同条件查询时，出现了结果不一致

   4. 存储过程、触发器：都是一堆SQL执行的函数，存储过程通过call方法调用；而触发器是通过触发时机(before、after)和事件(insert、update、delete)来触发
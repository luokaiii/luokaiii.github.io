<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="描述"><meta name="keywords" content="1,2,3"><meta name="author" content="koral"><meta name="copyright" content="koral"><title>凯 | 凯</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">koral</div><div class="author-info__description text-center">描述</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives/index.html"><span class="pull-left">文章</span><span class="pull-right">237</span></a><a class="author-info-articles__tags article-meta" href="/tags/index.html"><span class="pull-left">标签</span><span class="pull-right">29</span></a><a class="author-info-articles__categories article-meta" href="/categories/index.html"><span class="pull-left">分类</span><span class="pull-right">33</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/index.html">凯</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">首页</a><a class="site-page" href="/archives/index.html">归档</a><a class="site-page" href="/tags/index.html">标签</a><a class="site-page" href="/categories/index.html">分类</a><a class="site-page" href="/about/index.html">关于我</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">凯</div><div id="site-sub-title">凯</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2018/09/01/后端/SpringBootWebsocket/SpringBoot消息机制(一)-WebSocket介绍/index.html">SpringBoot消息机制(一)-WebSocket介绍</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-01</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Java/index.html">Java</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/MQ/index.html">MQ</a></span><div class="content"><p>#SpringBoot消息机制(一)-WebSocket介绍<br><a href="https://my.oschina.net/genghz/blog/1796965" target="_blank" rel="noopener">https://my.oschina.net/genghz/blog/1796965</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/09/01/分布式/SpringCloud/微服务重构/index.html">SpringCloud-微服务重构</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-01</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Java/index.html">Java</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Spring-Cloud/index.html">Spring Cloud</a></span><div class="content"><h1 id="微服务重构"><a href="#微服务重构" class="headerlink" title="微服务重构"></a>微服务重构</h1><p>在重构应用中，可以通过以下几个方法梳理：</p>
<ol>
<li>每个 Rest 服务都是一个潜在的微服务</li>
<li>每个 SOAP web 服务或 EJB 都是一个潜在的微服务</li>
<li>使用领域驱动设计(domain-driven design)发现企业资产，这些资产可能是微服务。</li>
</ol>
<p>在<strong>重构数据</strong>方面，需要考虑以下几个方面：(1)<strong>寻找与其他数据关联不大的数据孤岛</strong>，检查系统的实体-关系图；如果有与其他数据断开的数据，就是一个潜在的数据重构点；(2)<strong>数据表非规范化</strong>，对高规范化数据库中非规范化一些数据表以将数据重组为更大的逻辑块，其目的是增加数据冗余度使其更容易被打破；(3)<strong>反向批数据更新</strong>，对数据重构时需要考虑数据重构失败时可批量地将新数据反向导回旧的数据模式；(4)<strong>使用主数据管理</strong>，对被广泛使用的数据实体组成一个单一的一致性视图，并开发相应的微服务与主数据一起工作；(5)在SQL数据库中<strong>寻找存储在BLOB(二进制大对象)字段</strong>类型中的代码，转而将这些对象存储在NoSQL数据库中，例如以键值(Key-value)存储方式存储；(6)寻找活跃的记录模式，与其他无关的Flat对象，使用文档模式数据库进行存储，例如Cloudant或Mongo等。</p>
<p>微服务重构后还需要<strong>重新打包应用</strong>，包括：(1)<strong>分割应用的EAR文件</strong>并打包成独立的WAR文件；(2)应用“<strong>一个容器一个服务</strong>”，分别部署每个WAR文件至其自有的WebSphereLiberty实例运行时或Docker容器中；(3)<strong>分别构建、部署和管理</strong>,为每个WAR文件使用独立的DevOps管线,每个WAR文件独立伸缩和管理。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/09/01/分布式/SpringCloud/全链路监控/index.html">待学习</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-01</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Java/index.html">Java</a></span><div class="content"><h1 id="待学习博客"><a href="#待学习博客" class="headerlink" title="待学习博客"></a>待学习博客</h1><p><a href="https://juejin.im/post/5a7a9e0af265da4e914b46f1" target="_blank" rel="noopener">全链路监控</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/09/01/后端/POI/POI生成原生Excel-簇状柱状图/index.html">使用POI结合Excel的行列生成原生散点图(XY图)</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-01</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Java/index.html">Java</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/POI/index.html">POI</a></span><div class="content"><h1 id="使用POI结合Excel的行列生成原生散点图-XY图"><a href="#使用POI结合Excel的行列生成原生散点图-XY图" class="headerlink" title="使用POI结合Excel的行列生成原生散点图(XY图)"></a>使用POI结合Excel的行列生成原生散点图(XY图)</h1><h2 id="一、先放最后输出的结果图："><a href="#一、先放最后输出的结果图：" class="headerlink" title="一、先放最后输出的结果图："></a>一、先放最后输出的结果图：</h2><p><img src="https://koral-home.oss-cn-beijing.aliyuncs.com/blog/ScatterChart.png" alt="雷达图"></p>
<h2 id="二、代码"><a href="#二、代码" class="headerlink" title="二、代码"></a>二、代码</h2><pre><code class="java">@Test
public void createScatterChart() throws IOException {
    XSSFWorkbook wb = new XSSFWorkbook();
    XSSFSheet sheet = wb.createSheet(&quot;散点图&quot;);

    Row row;
    Cell cell;
    for (int r = 0; r &lt; 105; r++) {
        row = sheet.createRow(r);
        cell = row.createCell(0);
        cell.setCellValue(&quot;S&quot; + r);
        cell = row.createCell(1);
        cell.setCellValue(RandomUtils.nextInt(1,100));
    }

    XSSFDrawing drawing = sheet.createDrawingPatriarch();
    ClientAnchor anchor = drawing.createAnchor(0, 0, 0, 0, 0, 0, 21, 40);

    XSSFChart chart = drawing.createChart(anchor);

    chart.setTitleText(&quot;预选赛项目得分分布图&quot;);
    chart.setAutoTitleDeleted(false);

    CTChart ctChart = chart.getCTChart();
    ctChart.addNewPlotVisOnly().setVal(true);
    ctChart.addNewDispBlanksAs().setVal(STDispBlanksAs.Enum.forInt(2));
    ctChart.addNewShowDLblsOverMax().setVal(false);

    // 创建一个散点图
    CTPlotArea ctPlotArea = ctChart.getPlotArea();

    CTScatterChart scatterChart = ctPlotArea.addNewScatterChart();
    scatterChart.addNewScatterStyle().setVal(STScatterStyle.LINE_MARKER);
    scatterChart.addNewVaryColors().setVal(false); // 不允许自定义颜色
    scatterChart.addNewAxId().setVal(123456);
    scatterChart.addNewAxId().setVal(123457);

    CTCatAx ctCatAx = ctPlotArea.addNewCatAx();
    ctCatAx.addNewAxId().setVal(123456);
    CTScaling ctScaling = ctCatAx.addNewScaling();
    ctScaling.addNewOrientation().setVal(MIN_MAX);
    ctCatAx.addNewDelete().setVal(false);
    ctCatAx.addNewAxPos().setVal(STAxPos.B);
    ctCatAx.addNewCrossAx().setVal(123457);
    ctCatAx.addNewTickLblPos().setVal(NEXT_TO);

    // 设置Y坐标
    CTValAx ctValAx = ctPlotArea.addNewValAx();
    ctValAx.addNewAxId().setVal(123457);
    CTScaling ctScaling1 = ctValAx.addNewScaling();
    ctScaling1.addNewOrientation().setVal(MIN_MAX);
    ctValAx.addNewDelete().setVal(false);
    ctValAx.addNewAxPos().setVal(STAxPos.B);
    ctValAx.addNewCrossAx().setVal(123456);
    // Y轴的对比线
    CTShapeProperties ctShapeProperties = ctValAx.addNewMajorGridlines().addNewSpPr();
    CTLineProperties ctLineProperties = ctShapeProperties.addNewLn();
    ctLineProperties.setW(9525);
    ctLineProperties.setCap(STLineCap.Enum.forInt(3));
    ctLineProperties.setCmpd(STCompoundLine.Enum.forInt(1));
    ctLineProperties.setAlgn(STPenAlignment.Enum.forInt(1));
    // 不显示Y轴上的坐标刻度线
    ctValAx.addNewMajorTickMark().setVal(STTickMark.NONE);
    ctValAx.addNewMinorTickMark().setVal(STTickMark.NONE);
    ctValAx.addNewTickLblPos().setVal(NEXT_TO);

    // 设置散点图内的信息
    CTScatterSer ctScatterSer = scatterChart.addNewSer();
    ctScatterSer.addNewIdx().setVal(0);
    ctScatterSer.addNewOrder().setVal(0);
    // 去掉连接线
    ctPlotArea.getScatterChartArray(0).getSerArray(0).addNewSpPr().addNewLn().addNewNoFill();

    // 设置散点图各图例的显示
    CTDLbls ctdLbls = scatterChart.addNewDLbls();
    ctdLbls.addNewShowVal().setVal(true);
    ctdLbls.addNewShowLegendKey().setVal(false);
    ctdLbls.addNewShowSerName().setVal(false);
    ctdLbls.addNewShowCatName().setVal(false);
    ctdLbls.addNewShowPercent().setVal(false);
    ctdLbls.addNewShowBubbleSize().setVal(false);
    // 设置标记的样式
    CTMarker ctMarker = ctScatterSer.addNewMarker();
    ctMarker.addNewSymbol().setVal(STMarkerStyle.Enum.forInt(3));
    ctMarker.addNewSize().setVal((short) 5);
    CTShapeProperties ctShapeProperties1 = ctMarker.addNewSpPr();
    ctShapeProperties1.addNewSolidFill().addNewSchemeClr().setVal(STSchemeColorVal.Enum.forInt(5));
    CTLineProperties ctLineProperties1 = ctShapeProperties1.addNewLn();
    ctLineProperties1.setW(9525);
    ctLineProperties1.addNewSolidFill().addNewSchemeClr().setVal(STSchemeColorVal.Enum.forInt(5));

    CTAxDataSource ctAxDataSource = ctScatterSer.addNewXVal();
    CTStrRef ctStrRef = ctAxDataSource.addNewStrRef();
    ctStrRef.setF(&quot;散点图!$A$1:$A$100&quot;);
    CTNumDataSource ctNumDataSource = ctScatterSer.addNewYVal();
    CTNumRef ctNumRef = ctNumDataSource.addNewNumRef();
    ctNumRef.setF(&quot;散点图!$B$1:$B$100&quot;);

    System.out.println(ctChart);

    FileOutputStream fileOut = new FileOutputStream(&quot;C:\\Users\\user\\Desktop\\out.xlsx&quot;);
    wb.write(fileOut);
    fileOut.close();
}</code></pre>
<h2 id="三、XML结构"><a href="#三、XML结构" class="headerlink" title="三、XML结构"></a>三、XML结构</h2><p>以上生成的图表，归根结底是属于XML的一种，通过 <code>Chart</code> 的继承关系可以看到，它其实是 <code>XmlObject</code>的一种实现。</p>
<pre><code class="xml">&lt;xml-fragment xmlns:char=&quot;http://schemas.openxmlformats.org/drawingml/2006/chart&quot; xmlns:main=&quot;http://schemas.openxmlformats.org/drawingml/2006/main&quot;&gt;
  &lt;char:title&gt;
    &lt;char:tx&gt;
      &lt;char:rich&gt;
        &lt;main:bodyPr/&gt;
        &lt;main:p&gt;
          &lt;main:r&gt;
            &lt;main:t&gt;预选赛项目得分分布图&lt;/main:t&gt;
          &lt;/main:r&gt;
        &lt;/main:p&gt;
      &lt;/char:rich&gt;
    &lt;/char:tx&gt;
  &lt;/char:title&gt;
  &lt;char:autoTitleDeleted val=&quot;false&quot;/&gt;
  &lt;char:plotArea&gt;
    &lt;char:layout/&gt;
    &lt;char:scatterChart&gt;
      &lt;char:scatterStyle val=&quot;lineMarker&quot;/&gt;
      &lt;char:varyColors val=&quot;false&quot;/&gt;
      &lt;char:ser&gt;
        &lt;char:idx val=&quot;0&quot;/&gt;
        &lt;char:order val=&quot;0&quot;/&gt;
        &lt;char:spPr&gt;
          &lt;main:ln&gt;
            &lt;main:noFill/&gt;
          &lt;/main:ln&gt;
        &lt;/char:spPr&gt;
        &lt;char:marker&gt;
          &lt;char:symbol val=&quot;diamond&quot;/&gt;
          &lt;char:size val=&quot;5&quot;/&gt;
          &lt;char:spPr&gt;
            &lt;main:solidFill&gt;
              &lt;main:schemeClr val=&quot;accent1&quot;/&gt;
            &lt;/main:solidFill&gt;
            &lt;main:ln w=&quot;9525&quot;&gt;
              &lt;main:solidFill&gt;
                &lt;main:schemeClr val=&quot;accent1&quot;/&gt;
              &lt;/main:solidFill&gt;
            &lt;/main:ln&gt;
          &lt;/char:spPr&gt;
        &lt;/char:marker&gt;
        &lt;char:xVal&gt;
          &lt;char:strRef&gt;
            &lt;char:f&gt;散点图!$A$1:$A$100&lt;/char:f&gt;
          &lt;/char:strRef&gt;
        &lt;/char:xVal&gt;
        &lt;char:yVal&gt;
          &lt;char:numRef&gt;
            &lt;char:f&gt;散点图!$B$1:$B$100&lt;/char:f&gt;
          &lt;/char:numRef&gt;
        &lt;/char:yVal&gt;
      &lt;/char:ser&gt;
      &lt;char:dLbls&gt;
        &lt;char:showLegendKey val=&quot;false&quot;/&gt;
        &lt;char:showVal val=&quot;true&quot;/&gt;
        &lt;char:showCatName val=&quot;false&quot;/&gt;
        &lt;char:showSerName val=&quot;false&quot;/&gt;
        &lt;char:showPercent val=&quot;false&quot;/&gt;
        &lt;char:showBubbleSize val=&quot;false&quot;/&gt;
      &lt;/char:dLbls&gt;
      &lt;char:axId val=&quot;123456&quot;/&gt;
      &lt;char:axId val=&quot;123457&quot;/&gt;
    &lt;/char:scatterChart&gt;
    &lt;char:catAx&gt;
      &lt;char:axId val=&quot;123456&quot;/&gt;
      &lt;char:scaling&gt;
        &lt;char:orientation val=&quot;minMax&quot;/&gt;
      &lt;/char:scaling&gt;
      &lt;char:delete val=&quot;false&quot;/&gt;
      &lt;char:axPos val=&quot;b&quot;/&gt;
      &lt;char:tickLblPos val=&quot;nextTo&quot;/&gt;
      &lt;char:crossAx val=&quot;123457&quot;/&gt;
    &lt;/char:catAx&gt;
    &lt;char:valAx&gt;
      &lt;char:axId val=&quot;123457&quot;/&gt;
      &lt;char:scaling&gt;
        &lt;char:orientation val=&quot;minMax&quot;/&gt;
      &lt;/char:scaling&gt;
      &lt;char:delete val=&quot;false&quot;/&gt;
      &lt;char:axPos val=&quot;b&quot;/&gt;
      &lt;char:majorGridlines&gt;
        &lt;char:spPr&gt;
          &lt;main:ln w=&quot;9525&quot; cap=&quot;flat&quot; cmpd=&quot;sng&quot; algn=&quot;ctr&quot;/&gt;
        &lt;/char:spPr&gt;
      &lt;/char:majorGridlines&gt;
      &lt;char:majorTickMark val=&quot;none&quot;/&gt;
      &lt;char:minorTickMark val=&quot;none&quot;/&gt;
      &lt;char:tickLblPos val=&quot;nextTo&quot;/&gt;
      &lt;char:crossAx val=&quot;123456&quot;/&gt;
    &lt;/char:valAx&gt;
  &lt;/char:plotArea&gt;
  &lt;char:plotVisOnly val=&quot;true&quot;/&gt;
  &lt;char:plotVisOnly val=&quot;true&quot;/&gt;
  &lt;char:dispBlanksAs val=&quot;gap&quot;/&gt;
  &lt;char:showDLblsOverMax val=&quot;false&quot;/&gt;
&lt;/xml-fragment&gt;</code></pre>
<h2 id="四、工具类，我放在-POI生成原生图表-工具类-中"><a href="#四、工具类，我放在-POI生成原生图表-工具类-中" class="headerlink" title="四、工具类，我放在 POI生成原生图表-工具类 中"></a>四、工具类，我放在 <a href="www.baidu.com">POI生成原生图表-工具类</a> 中</h2></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2018/09/01/后端/POI/poi操作word生成textbox/index.html">poi����word����textbox</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-01</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Java/index.html">Java</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/POI/index.html">POI</a></span><div class="content"><pre><code class="java">public static void main(String[] args) throws Exception {

?```
    XWPFDocument document = new XWPFDocument();

    XWPFParagraph paragraph = document.createParagraph();
    XWPFRun run =  paragraph.createRun();
    run.setText(&quot;Callout shape over text: Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor Lorem ipsum semit dolor.&quot;);

    appendCalloutShape(run, &quot;200pt&quot;, &quot;0&quot;, &quot;1in&quot;, &quot;1in&quot;, &quot;black&quot;, &quot;#00FF00&quot;, &quot;The callout\ntext...&quot;, false);

    paragraph = document.createParagraph();
    paragraph = document.createParagraph();
    paragraph = document.createParagraph();
    paragraph = document.createParagraph();
    run =  paragraph.createRun();
    run.setText(&quot;Callout shape:&quot;);

    appendCalloutShape(run, &quot;1in&quot;, &quot;-150px&quot;, &quot;100px&quot;, &quot;150px&quot;, &quot;#0000FF&quot;, &quot;yellow&quot;, &quot;The callout\ntext...&quot;, true);
?```

?```
    FileOutputStream out = new FileOutputStream(&quot;C:\\Users\\user\\Desktop\\converter\\����.docx&quot;);
    document.write(out);
    out.close();
    document.close();
}

public static void appendCalloutShape(XWPFRun run, String left, String top, String width, String height,
                                      String strokecolor, String fillcolor, String calloutext, boolean hashandles) throws Exception {
    CTGroup ctGroup = CTGroup.Factory.newInstance();

    CTShape ctShape = ctGroup.addNewShape();
    ctShape.setCoordsize(&quot;21600,21600&quot;);
    if (hashandles) { //is not Libreoffice Writer compatible
        ctShape.setAdj(&quot;&quot; + 21600*1/3 + &quot;,21600&quot;);
        CTFormulas cTFormulas = ctShape.addNewFormulas();
        cTFormulas.addNewF().setEqn(&quot;val #0&quot;);
        cTFormulas.addNewF().setEqn(&quot;val #1&quot;);
        ctShape.setPath2(&quot;m 1,1 l 1,&quot; + 21600*2/3 + &quot;, &quot; + 21600*1/3 + &quot;,&quot; + 21600*2/3 + &quot;, @0,@1, &quot; + 21600*2/3 + &quot;,&quot; + 21600*2/3 + &quot;, 21600,&quot; + 21600*2/3 + &quot;, 21600,1 x e&quot;);
        ctShape.addNewHandles().addNewH().setPosition(&quot;#0,#1&quot;);
    } else { // is Libreoffice Writer compatible
        ctShape.setPath2(&quot;m 1,1 l 1,&quot; + 21600*2/3 + &quot;, &quot; + 21600*1/3 + &quot;,&quot; + 21600*2/3 + &quot;, &quot; + 21600*1/3 + &quot;,21600, &quot; + 21600*2/3 + &quot;,&quot; + 21600*2/3 + &quot;, 21600,&quot; + 21600*2/3 + &quot;, 21600,1 x e&quot;);
    }

    ctShape.addNewPath().setTextboxrect(&quot;1,1,21600,&quot; + 21600*2/3);

    ctShape.setStyle(&quot;position:absolute;margin-left:&quot; + left + &quot;;margin-top:&quot; + top + &quot;;width:&quot; + width + &quot;;height:&quot; + height + &quot;;z-index:251659264;visibility:visible;rotation:0;&quot;);
    ctShape.setStrokecolor(strokecolor);
    ctShape.setFillcolor(fillcolor);

    CTTextbox cTTextbox = ctShape.addNewTextbox();

    CTTxbxContent ctTxbxContent = cTTextbox.addNewTxbxContent();
    XWPFParagraph textboxparagraph = new XWPFParagraph(ctTxbxContent.addNewP(), run.getDocument());
    XWPFRun textboxrun = null;
    String[] lines = calloutext.split(&quot;\n&quot;);
    for (int i = 0; i &lt; lines.length; i++) {
        textboxrun = textboxparagraph.createRun();
        textboxrun.setText(lines[i]);
        textboxrun.addBreak();
    }

    Node ctGroupNode = ctGroup.getDomNode();
    CTPicture ctPicture = CTPicture.Factory.parse(ctGroupNode);
    CTR cTR = run.getCTR();
    cTR.addNewPict();
    cTR.setPictArray(0, ctPicture);
}
?```

https://stackoverflow.com/questions/53834805/how-to-create-a-wedgerectcallout-shape-in-word-using-apache-poi</code></pre>
<pre><code class="java">
// �ı����еă��ݺ��韩
        XmlObject object = paragraph.getCTP().getRArray(1);
        XmlCursor cursor = object.newCursor();

        // ���Դ�ӡXmlObject�������鿴��ǰxml�ļ�����
        // Ҳ��ͨ��XmlCursor��getName��getTextValue�����鿴��ǰ����Node����ֵ
        // �ҵĵ�һ��Ҫ�޸ĵ���������nodeΪ:ע��index
        // &lt;xml-fragment&gt; -&gt; &lt;w:pict&gt; -&gt; &lt;v:shape&gt; -&gt; &lt;v:textbox&gt; -&gt;
        // &lt;w:txbxContent&gt; -&gt; &lt;w:p&gt; -&gt; &lt;w:r&gt; -&gt; &lt;w:t&gt;
        cursor.toChild(1);
        cursor.toChild(0);
        cursor.toChild(3);
        cursor.toChild(0);

        cursor.toChild(0);
        cursor.toChild(3);
        cursor.toChild(1);
        cursor.setTextValue(&quot;First&quot;);

        // �ҵĵڶ���Ҫ�޸ĵ���������nodeΪ��ע��index
        // &lt;w:txbxContent&gt; -&gt; &lt;w:p&gt; -&gt; &lt;w:r&gt; -&gt; &lt;w:t&gt;
        cursor.toParent();
        cursor.toParent();
        cursor.toParent();
        cursor.toChild(1);
        cursor.toChild(3);
        cursor.toChild(1);
        cursor.setTextValue(&quot;Second&quot;);</code></pre>
<p>ͨ�� freemarker + flying-saucer-pdf ����������Ⱦ�� html���ٽ�htmlת�� pdf���������ڣ�ֻ��֧�� ����ͺ��� ��������</p>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/45/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/45/">45</a><span class="page-number current">46</span><a class="page-number" href="/page/47/">47</a><a class="page-number" href="/page/48/">48</a><a class="extend next" rel="next" href="/page/47/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By koral</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>
<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="罗凯的博客主页"><meta name="keywords" content="博客,全栈工程师,前端工程师,后端工程师,运维工程师,罗凯的博客,罗凯,DevOps,技术博客"><meta name="author" content="koral"><meta name="copyright" content="koral"><title>现在的我可以做点什么，让未来的我可以受益匪浅？ | 凯</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">koral</div><div class="author-info__description text-center">罗凯的博客主页</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">314</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">48</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">59</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/index.html">凯</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">首页</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a><a class="site-page" href="/about">关于我</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">凯</div><div id="site-sub-title">现在的我可以做点什么，让未来的我可以受益匪浅？</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/21/前端/UmiHooks/State/useHistoryTravel/">《Umi Hooks》官网笔记-useHistoryTravel</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/Umi-Hooks/">Umi/Hooks</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umi-Hooks/">Umi/Hooks</a></span><div class="content"><h1 id="useHistoryTravel"><a href="#useHistoryTravel" class="headerlink" title="useHistoryTravel"></a>useHistoryTravel</h1><p>优雅的管理状态变化历史，可以快速在状态变化历史中穿梭 - 前进和后退。</p>
<h2 id="一、API"><a href="#一、API" class="headerlink" title="一、API"></a>一、API</h2><pre><code class="js">const {
    // 当前值
    value,
    // 设值函数
    setValue,
    // 可回退历史长度
    backLength,
    // 可前进历史长度
    forwardLength,
    // 历史穿梭函数：(step: number) =&gt; void
    go,
    // 后退一步
    back,
    // 前进一步
    foward
} = useHistoryTravel&lt;T&gt;(
    // 初始值
    initialValue?: T
);</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/21/前端/UmiHooks/Dom/useKeyPress/">《Umi Hooks》官网笔记-useKeyPress</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/Umi-Hooks/">Umi/Hooks</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umi-Hooks/">Umi/Hooks</a></span><div class="content"><h1 id="useKeyPress"><a href="#useKeyPress" class="headerlink" title="useKeyPress"></a>useKeyPress</h1><p>一个优雅的管理 keyup 和 keydown 键盘事件的 Hook，支持键盘组合键，定义键盘事件的 key 和 keyCode 别名输入。</p>
<pre><code class="js">// ref：    当未传入任何 target 时，将 ref 绑定给需监听的节点
const ref = useKeyPress(
    // 支持键盘事件中的 key 和 keyCode，支持回调方式返回 boolean 判断，支持别名使用
    keyFilter: KeyFilter,
    eventHandler: EventHandler = noop,
    options?: {
        // 触发事件
        events,
        target
    }
)</code></pre>
<p><strong>备注：按键别名</strong></p>
<pre><code class="tex">enter
tab
delete
esc
space
up
down
left
right
ctrl
alt
shift
meta</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/21/前端/UmiHooks/UI/useDrag&amp;useDrop/">《Umi Hooks》官网笔记-useDrop &amp; useDrag</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/Umi-Hooks/">Umi/Hooks</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umi-Hooks/">Umi/Hooks</a></span><div class="content"><h1 id="useDrop-amp-useDrag"><a href="#useDrop-amp-useDrag" class="headerlink" title="useDrop &amp; useDrag"></a>useDrop &amp; useDrag</h1><p>一对能帮助处理拖拽中 进行数据转移 的 hooks。</p>
<blockquote>
<p>useDrop 可能单独使用来接收文件、文字和网址的拖拽。</p>
<p>useDrag 允许一个 dom 节点被拖拽，需要配合 useDrop 使用。</p>
<p>向节点内触发粘贴时也会被视为拖拽的内容。</p>
</blockquote>
<h2 id="一、API"><a href="#一、API" class="headerlink" title="一、API"></a>一、API</h2><pre><code class="js">// getDragProps：一个接收拖拽的值，并返回需要透传给被拖拽节点 props 的方法
const getDragProps = useDrag();

&lt;div {...getDragProps(id)}&gt;draggable&lt;/div&gt;

/**
 * props: 需要透传给接受拖拽区域 dom 节点的 props
 * isHovering：是否拖拽中，且光标处于释放区域内
 */
const [ props, { isHovering } ] = useDrop({
    // 拖拽文字的回调
    onText: (text: string, e: Event) =&gt; void,
    // 拖拽文件的回调
    onFiles: (files: File[], e: Event) =&gt; void,
    // 拖拽链接的回调
    onUri: (uri: string, e: Event) =&gt; void,
    // 拖拽自定义 dom 节点的回调
    onDom: (content: any, e: Event) =&gt; void
})</code></pre>
<h2 id="二、示例"><a href="#二、示例" class="headerlink" title="二、示例"></a>二、示例</h2><p>拖拽区域可以接受文件、链接、文字和下方的box节点。</p>
<pre><code class="tsx">import React, { useState } from &#39;react&#39;;
import { message } from &#39;antd&#39;;
import { useDrop, useDrag } from &#39;@umijs/hooks&#39;;

export default () =&gt; {
  const getDragProps = useDrag();
  const [props, { isHovering }] = useDrop({
    onText: (text) =&gt; {
      message.success(`text:${text}`);
    },
    onFiles: (files) =&gt; {
      message.success(`files: ${files.length}`);
    },
    onUri: (uri) =&gt; {
      message.success(`uri: ${uri}`);
    },
    onDom: (content) =&gt; {
      message.success(`content: ${content}`);
    },
  });
  return (
    &lt;div&gt;
      &lt;div style={{ border: '1px dashed #e8e8e8', padding: 16, textAlign: 'center' }} {...props}&gt;
        {isHovering ? &#39;放这儿&#39; : &#39;拖到这儿&#39;}
      &lt;/div&gt;
      &lt;div style={{ display: 'flex', marginTop: 8 }}&gt;
        {Array.from(Array(5)).map((e, i) =&gt; (
          &lt;div
            {...getDragProps(`box${i}`)}
            style={{
              border: '1px solid #e8e8e8',
              padding: 16,
              width: 80,
              textAlign: 'center',
              marginRight: 16,
            }}
          &gt;
            box[i]
          &lt;/div&gt;
        ))}
       &lt;a href=&quot;www.baidu.com&quot;&gt;baidu&lt;/a&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
};</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/21/前端/UmiHooks/UI/useDynamicList/">《Umi Hooks》官网笔记-useDynamicList</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/Umi-Hooks/">Umi/Hooks</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umi-Hooks/">Umi/Hooks</a></span><div class="content"><h1 id="useDynamicList"><a href="#useDynamicList" class="headerlink" title="useDynamicList"></a>useDynamicList</h1><p>一个帮助你管理列表状态，并能生成唯一 key 的 Hook。</p>
<h2 id="一、API"><a href="#一、API" class="headerlink" title="一、API"></a>一、API</h2><pre><code class="js">const {
    // 当前的列表：T[]
    list,
    // 重新设置 list 的值：(list: T[]) =&gt; void
    resetList,
    // 在指定位置插入元素：(index: number, obj: T) =&gt; void
    insert,
    // 在指定位置插入多个元素：(index: number, obj: T) =&gt; void
    merge,
    // 替换指定元素：(index: number, obj: T) =&gt; void
    replace,
    // 删除指定元素：(index: number) =&gt; void
    remove,
    // 移动元素：(oldIndex: number, newIndex: number) =&gt; void
    move,
    // 获得某个元素的 UUID：(index: number) =&gt; number
    getKey,
    // 获得某个 key 的 index：(key: number) =&gt; number
    getIndex,
    // 根据表单结果自动排序：(list: unKnown[]) =&gt; unKnown[]
    sortForm,
    // 在列表末尾添加元素：(obj: T) =&gt; void
    push,
    // 移除末尾元素：() =&gt; void
    pop,
    // 在列表起始位置添加元素：(obj: T) =&gt; void
    unshift,
    // 移除起始位置元素：() =&gt; void
    shift
} = useDynamicList(
    // 列表的初始值：T[]
    initialValue: T[]
);</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/21/前端/UmiHooks/UI/useSelections/">《Umi Hooks》官网笔记-useSelections</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/Umi-Hooks/">Umi/Hooks</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umi-Hooks/">Umi/Hooks</a></span><div class="content"><h1 id="useSelections"><a href="#useSelections" class="headerlink" title="useSelections"></a>useSelections</h1><p>常见联动的 checkbox 逻辑封装，支持多选、单选、全选逻辑，还提供了是否选择、是否全选、是否半选的状态。</p>
<h2 id="一、API"><a href="#一、API" class="headerlink" title="一、API"></a>一、API</h2><pre><code class="js">const {
    // 已经选择的元素，array
    selected,
    // 是否被选择，func
    isSelected,
    // 选择元素，func
    select,
    // 取消选择元素，func
    unSelect,
    // 反选元素，func
    toggle,
    // 选择全部元素，func
    selectAll,
    // 取消选择全部元素，func
    unSelectAll,
    // 反选全部元素，func
    toggleAll,
    // 是否全选，boolean
    allSelected,
    // 是否一个都没有选择，boolean
    noneSelected,
    // 是否半选
    partiallySelected,
    // 设置选择的元素
    setSelected
} = useSelections&lt;T&gt;(items: T[], defaultSelected?: T[]);</code></pre>
<h2 id="二、示例"><a href="#二、示例" class="headerlink" title="二、示例"></a>二、示例</h2><p>常见的checkbox联动</p>
<pre><code class="tsx">import React, { useMemo, useState } from &#39;react&#39;;
import { Checkbox, Row, Col } from &#39;antd&#39;;
import { useSelections } from &#39;@umijs/hooks&#39;;

export default () =&gt; {
  const [hideOdd, setHideOdd] = useState(false);

  const list = useMemo(() =&gt; {
    if (hideOdd) {
      return [2, 4, 6, 8];
    }
    return [1, 2, 3, 4, 5, 6, 7, 8];
  }, [hideOdd]);

  const {
    selected,
    allSelected,
    isSelected,
    toggle,
    toggleAll,
    partiallySelected,
  } = useSelections(list, [1]);

  return (
    &lt;div&gt;
      &lt;div&gt;Selected: {selected.join(&#39;,&#39;)}&lt;/div&gt;
      &lt;div style={{ borderBottom: '1px solid #e8e8e8', padding: '10px 0' }}&gt;
        &lt;Checkbox checked={allSelected} onClick={toggleAll} indeterminate={partiallySelected}&gt;
          全选
        &lt;/Checkbox&gt;
        &lt;Checkbox checked={hideOdd} onClick={() =&gt; setHideOdd((v) =&gt; !v)}&gt;
          隐藏部分
        &lt;/Checkbox&gt;
      &lt;/div&gt;
      &lt;Row style={{ padding: '10px 0' }}&gt;
        {list.map((o) =&gt; (
          &lt;Col span={12} key={o}&gt;
            &lt;Checkbox checked={isSelected(o)} onClick={() =&gt; toggle(o)}&gt;
              {o}
            &lt;/Checkbox&gt;
          &lt;/Col&gt;
        ))}
      &lt;/Row&gt;
    &lt;/div&gt;
  );
};</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/21/前端/UmiHooks/UI/useVirtualList/">《Umi Hooks》官网笔记-useVirtualList</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/Umi-Hooks/">Umi/Hooks</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umi-Hooks/">Umi/Hooks</a></span><div class="content"><h1 id="useVirtualList"><a href="#useVirtualList" class="headerlink" title="useVirtualList"></a>useVirtualList</h1><p>提供虚拟化列表能力的 Hook，用于解决展示海量数据渲染时首屏渲染缓慢和滚动卡顿问题。</p>
<h2 id="一、API"><a href="#一、API" class="headerlink" title="一、API"></a>一、API</h2><pre><code class="js">const {
    // 当前需要展示的列表内容
    list,
    // 滚动容器的 props
    containerProps,
    // children 外层包裹器 props
    wrapperProps,
    // 快速滚动到指定 index
    scrollTo
} = useVirtualList(
    // 包含大量数据的列表
    originalList: any[],
    options: {
        // 行高度，静态高度可以直接写入像素值，动态高度可传入函数
        itemHeight,
        // 视区上、下额外展示的 dom 节点数量
        overscan
    }
)</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/21/前端/UmiHooks/SideEffect/useDebounceFn/">《Umi Hooks》官网笔记-useDebounceFn</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/Umi-Hooks/">Umi/Hooks</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umi-Hooks/">Umi/Hooks</a></span><div class="content"><h1 id="useDebounceFn"><a href="#useDebounceFn" class="headerlink" title="useDebounceFn"></a>useDebounceFn</h1><p>用来处理防抖函数的 Hook。</p>
<h2 id="一、API"><a href="#一、API" class="headerlink" title="一、API"></a>一、API</h2><pre><code class="js">const {
    // 触发执行fn，函数参数将会传递给fn：(...args: any[]) =&gt; any
    run,
    // 取消当前防抖：() =&gt; void
    cancel
} = useDebounceFn(
    // 需要防抖执行的函数
    fn: (...args: any[]) =&gt; any,
    // 依赖数组，如果数组变化，则会在等待时间后触发fn
    deps: any[],
    // 防抖等待时间(1000毫秒)
    wait: number
)</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/21/前端/UmiHooks/SideEffect/useThrottleFn/">《Umi Hooks》官网笔记-useThrottleFn</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/">前端</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/前端/Umi-Hooks/">Umi/Hooks</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umi-Hooks/">Umi/Hooks</a></span><div class="content"><h1 id="useThrottleFn"><a href="#useThrottleFn" class="headerlink" title="useThrottleFn"></a>useThrottleFn</h1><p>用来处理函数节流的 Hook。</p>
<h2 id="一、API"><a href="#一、API" class="headerlink" title="一、API"></a>一、API</h2><pre><code class="js">const {
    // 触发执行fn，函数参数将会传递给fn
    run,
    // 取消当前节流
    cancel
} = useThrottleFn(
    // 需要节流的函数
    fn: (...args: any[]) =&gt; any,
    // 依赖数组，如果数组变化，则会在节流后，触发fn
    deps: any[],
    // 节流间隔时间(默认1000毫秒)
    wait: number
)</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/07/读书笔记/《Umijs》官方文档/0.目录/">《Umijs》官方文档</a><span class="article-meta"><i class="fa fa-thumb-tack article-meta__icon sticky"></i><span class="sticky">置顶</span><span class="article-meta__separator" style="margin-right: 0.3rem">|</span></span><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/读书笔记/">读书笔记</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/读书笔记/Umijs/">Umijs</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umijs/">Umijs</a></span><div class="content"><ul>
<li>第一部分 <a href="/2020/04/07/读书笔记/《Umijs》官方文档/1.目录结构与路由/index.html">目录结构与路由</a></li>
<li>第二部分 <a href="/2020/04/07/读书笔记/《Umijs》官方文档/2.约定式路由/index.html">约定式路由</a></li>
<li>第三部分 <a href="/2020/04/07/读书笔记/《Umijs》官方文档/3.页面跳转与HTML模板/index.html">页面跳转与 HTML 模板</a></li>
<li>第四部分 <a href="/2020/04/07/读书笔记/《Umijs》官方文档/4.Mock数据/index.html">Mock 数据</a></li>
<li>第五部分 <a href="/2020/04/07/读书笔记/《Umijs》官方文档/5.环境变量/index.html">环境变量</a></li>
<li>第六部分 <a href="/2020/04/07/读书笔记/《Umijs》官方文档/6.样式与图片/index.html">样式与图片的引入</a></li>
</ul></div><a class="more" href="/2020/04/07/读书笔记/《Umijs》官方文档/0.目录/#more">阅读更多</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/04/07/读书笔记/《Umijs》官方文档/1.目录结构与路由/">《Umijs》一、目录结构与路由</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/读书笔记/">读书笔记</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/读书笔记/Umijs/">Umijs</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hide/">hide</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Umijs/">Umijs</a></span><div class="content"><h2 id="一、目录结构"><a href="#一、目录结构" class="headerlink" title="一、目录结构"></a>一、目录结构</h2><h3 id="1-env-环境变量"><a href="#1-env-环境变量" class="headerlink" title="1. .env 环境变量"></a>1. <code>.env</code> 环境变量</h3><pre><code class="properties">PORT=8888
COMPRESS=none</code></pre>
<h3 id="2-src-umi-临时目录"><a href="#2-src-umi-临时目录" class="headerlink" title="2. /src/.umi 临时目录"></a>2. <code>/src/.umi</code> 临时目录</h3><p>如入口文件、路由等会临时生成到此。在 dev 和 build 时会被删除并重新生成。</p>
<h3 id="3-src-layouts"><a href="#3-src-layouts" class="headerlink" title="3. /src/layouts"></a>3. <code>/src/layouts</code></h3><p>约定式路由时的全局布局文件。</p>
<h3 id="4-src-app-ts"><a href="#4-src-app-ts" class="headerlink" title="4. /src/app.ts"></a>4. <code>/src/app.ts</code></h3><p>运行时配置文件，可扩展运行时能力，如修改路由、修改 render 方法等。</p>
<h2 id="二、路由"><a href="#二、路由" class="headerlink" title="二、路由"></a>二、路由</h2><p>Umi 属于单页应用，仅加载一次 html，其余所有跳转由浏览器端完成。</p>
<h3 id="1-exact-严格匹配"><a href="#1-exact-严格匹配" class="headerlink" title="1. exact 严格匹配"></a>1. exact 严格匹配</h3><p>type：boolean，default：false</p>
<pre><code class="ts">export default defineConfig({
  routes: [
    { path: &quot;/&quot;, component: &quot;@/pages/index&quot; },
    // 需要完全匹配
    { exact: true, path: &quot;/layout&quot;, component: &quot;@/layout/index&quot; },
  ],
});</code></pre>
<h3 id="2-配置子路由"><a href="#2-配置子路由" class="headerlink" title="2. 配置子路由"></a>2. 配置子路由</h3><pre><code class="ts">export default {
  routes: [
    {
      path: &quot;/&quot;,
      component: &quot;@/layout/index&quot;,
      routes: [
        { path: &quot;/admin&quot;, component: &quot;@/pages/admin&quot; },
        { path: &quot;/user&quot;, component: &quot;@/pages/user&quot; },
      ],
    },
  ],
};</code></pre>
<p>然后在 <code>/src/layout/index</code> 中通过 <code>props.children</code> 渲染子路由</p>
<pre><code class="ts">export default (props) =&gt; {
  return &lt;div&gt;{props.children}&lt;/div&gt;;
};</code></pre>
<p>这样，访问 <code>/admin</code> 和 <code>/user</code> 就会带上 layout 组件。</p>
<h3 id="3-redirect-跳转"><a href="#3-redirect-跳转" class="headerlink" title="3. redirect 跳转"></a>3. redirect 跳转</h3><pre><code class="ts">export default {
  routes: [
    { path: &quot;/&quot;, redirect: &quot;/user&quot; },
    { path: &quot;/user&quot;, component: &quot;@/pages/user&quot; },
  ],
};</code></pre>
<h3 id="4-wrappers"><a href="#4-wrappers" class="headerlink" title="4. wrappers"></a>4. wrappers</h3><p>配置路由的高阶组件封装，如路由级别的权限校验。 type: string[]</p>
<h4 id="路由配置"><a href="#路由配置" class="headerlink" title="路由配置"></a>路由配置</h4><pre><code class="ts">export default {
  routes: [
    { path: &quot;/&quot;, component: &quot;@/pages/index&quot;, wrappers: [&quot;@/wrappers/auth&quot;] },
    { path: &quot;/login&quot;, component: &quot;@/pages/login&quot; },
  ],
};</code></pre>
<h4 id="权限校验组件"><a href="#权限校验组件" class="headerlink" title="权限校验组件"></a>权限校验组件</h4><pre><code class="tsx">import React from &quot;react&quot;;
import { history } from &quot;umi&quot;;

const auth = (props: any) =&gt; {
  const random = Math.random();
  if (random &gt; 0.5) {
    history.push(&quot;/login&quot;);
  }

  return &lt;div&gt;{props.children}&lt;/div&gt;;
};

export default auth;</code></pre>
<blockquote>
<p>这样，访问 <code>/</code> 时，就会通过 <code>auth</code> 组件的权限校验，如果通过则渲染 <code>src/pages/index</code>，否则跳转至登录页。</p>
</blockquote>
<h3 id="5-路由组件参数"><a href="#5-路由组件参数" class="headerlink" title="5. 路由组件参数"></a>5. 路由组件参数</h3><p>路由组件可通过 <code>props</code> 获取到以下属性：</p>
<ul>
<li>match，当前路由和 url match 后的对象，包含 <code>params</code>、<code>path</code>、<code>url</code>和 <code>isExact</code></li>
<li>location，应用当前处于哪个位置，包含 <code>pathname</code>、<code>search</code>、<code>query</code>等属性</li>
<li>history</li>
<li>route，路由配置，包含<code>path</code>、<code>exact</code>、<code>component</code>、<code>routes</code>等</li>
</ul>
<h3 id="6-传递参数给子路由-cloneElement"><a href="#6-传递参数给子路由-cloneElement" class="headerlink" title="6. 传递参数给子路由 cloneElement"></a>6. 传递参数给子路由 cloneElement</h3><pre><code class="tsx">import React from &quot;react&quot;;

export default (props: any) =&gt; {
  return React.Children.map(props.children, (child) =&gt; {
    return React.cloneElement(child, { foo: &quot;bar&quot; });
  });
};</code></pre>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By koral</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>
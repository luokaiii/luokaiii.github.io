<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="POI+XChart图形报告"><meta name="keywords" content="POI"><meta name="author" content="koral"><meta name="copyright" content="koral"><title>POI+XChart图形报告 | 凯</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#POI-XChart图形报告"><span class="toc-number">1.</span> <span class="toc-text">POI+XChart图形报告</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、基础示例，写入Excel"><span class="toc-number">1.1.</span> <span class="toc-text">一、基础示例，写入Excel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、将生成的图形导出成为图片"><span class="toc-number">1.2.</span> <span class="toc-text">二、将生成的图形导出成为图片</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#折线图"><span class="toc-number">1.2.1.</span> <span class="toc-text">折线图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#面积图"><span class="toc-number">1.3.</span> <span class="toc-text">面积图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#饼状图"><span class="toc-number">1.4.</span> <span class="toc-text">饼状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#散点图"><span class="toc-number">1.5.</span> <span class="toc-text">散点图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#柱状图"><span class="toc-number">1.6.</span> <span class="toc-text">柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#堆叠图"><span class="toc-number">1.7.</span> <span class="toc-text">堆叠图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#百分比堆叠柱状图"><span class="toc-number">1.8.</span> <span class="toc-text">百分比堆叠柱状图</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">koral</div><div class="author-info__description text-center">描述</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">243</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">22</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">19</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">凯</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">POI+XChart图形报告</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-01</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="POI-XChart图形报告"><a href="#POI-XChart图形报告" class="headerlink" title="POI+XChart图形报告"></a>POI+XChart图形报告</h1><h2 id="一、基础示例，写入Excel"><a href="#一、基础示例，写入Excel" class="headerlink" title="一、基础示例，写入Excel"></a>一、基础示例，写入Excel</h2><p>生成一个图形，并将其写入 Excel 中。</p>
<pre><code class="java">@Test
public void generate() throws IOException {
    String filePath = &quot;C:\\Users\\user\\Desktop\\first.xlsx&quot;;
    double[] xData = new double[]{0.0, 1.0, 2.0};
    double[] yData = new double[]{2.0, 1.0, 0.0};

    // Create Chart
    XYChart chart = QuickChart.getChart(&quot;Sample Chart&quot;, &quot;X&quot;, &quot;Y&quot;, &quot;y(x)&quot;, xData, yData);
    // 将图表转换为byte数组
    byte[] bytes = BitmapEncoder.getBitmapBytes(chart, BitmapEncoder.BitmapFormat.PNG);

    try (XSSFWorkbook workbook = new XSSFWorkbook();
         ByteArrayInputStream inputStream = new ByteArrayInputStream(bytes);
         FileOutputStream outputStream = new FileOutputStream(filePath)) {
        // 创建Excel
        XSSFSheet sheet = workbook.createSheet(&quot;图表&quot;);

        // 写入Excel的指定位置
        XSSFDrawing shapes = sheet.createDrawingPatriarch();
        XSSFClientAnchor anchor = new XSSFClientAnchor(0, 0, 0, 0, 0, 0, 6, 10);
        shapes.createPicture(anchor, sheet.getWorkbook().addPicture(inputStream, HSSFWorkbook.PICTURE_TYPE_PNG));

        // 将Excel写到文件中
        workbook.write(outputStream);
    }
}</code></pre>
<p><img src="https://images.gitee.com/uploads/images/2019/0121/180421_34b56169_1872936.png" alt="生成的基础图片"></p>
<blockquote>
<p> 上面我们演示了如何<code>将 XChart生成的图片导入 Excel</code>，下面的部分，都会将生成的图形导出为图片，如果需要导入Excel的话，只需要将chart套入第一章即可。</p>
</blockquote>
<h2 id="二、将生成的图形导出成为图片"><a href="#二、将生成的图形导出成为图片" class="headerlink" title="二、将生成的图形导出成为图片"></a>二、将生成的图形导出成为图片</h2><p>获取随机数的方法也是通用的，这里先给出，具体的数据应该根据业务而定：</p>
<pre><code class="java">/**
     * 获取随机数
     * @param numPoints 随机的数量
     * @return 随机数组
     */
    private double[] getRandomWalk(int numPoints) {

        double[] y = new double[numPoints];
        y[0] = 0;
        for (int i = 1; i &lt; y.length; i++) {
            y[i] = y[i - 1] + Math.random() - .5;
        }
        return y;
    }</code></pre>
<h3 id="折线图"><a href="#折线图" class="headerlink" title="折线图"></a>折线图</h3><pre><code class="java">@Test
public void generate() throws IOException {
    String filePath = &quot;C:\\Users\\user\\Desktop\\first.png&quot;;

    XYChart chart = new XYChartBuilder().xAxisTitle(&quot;X&quot;).yAxisTitle(&quot;Y&quot;).width(600).height(400).build();
    chart.getStyler().setYAxisMin(-10.0);
    chart.getStyler().setYAxisMax(10.0);
    XYSeries series = chart.addSeries(&quot;新绿&quot;, null, getRandomWalk(200));
    series.setMarker(SeriesMarkers.NONE);

    BitmapEncoder.saveBitmap(chart, filePath, BitmapEncoder.BitmapFormat.PNG);
}</code></pre>
<p>效果如下：</p>
<p><img src="https://images.gitee.com/uploads/images/2019/0121/181356_e145341d_1872936.png" alt="输入图片说明" title="屏幕截图.png"></p>
<h2 id="面积图"><a href="#面积图" class="headerlink" title="面积图"></a>面积图</h2><pre><code class="java">@Test
public void generate() throws IOException {
    String filePath = &quot;C:\\Users\\user\\Desktop\\first.png&quot;;

    // Create Chart
    XYChart chart = new XYChartBuilder().width(800).height(600).title(getClass().getSimpleName()).xAxisTitle(&quot;X&quot;).yAxisTitle(&quot;Y&quot;).build();

    // Customize Chart
    chart.getStyler().setLegendPosition(Styler.LegendPosition.InsideNE);
    chart.getStyler().setAxisTitlesVisible(false);
    chart.getStyler().setDefaultSeriesRenderStyle(XYSeries.XYSeriesRenderStyle.Area);

    // Series
    chart.addSeries(&quot;a&quot;, new double[] { 0, 3, 5, 7, 9 }, new double[] { -3, 5, 9, 6, 5 });
    chart.addSeries(&quot;b&quot;, new double[] { 0, 2, 4, 6, 9 }, new double[] { -1, 6, 4, 0, 4 });
    chart.addSeries(&quot;c&quot;, new double[] { 0, 1, 3, 8, 9 }, new double[] { -2, -1, 1, 0, 1 });

    BitmapEncoder.saveBitmap(chart, filePath, BitmapEncoder.BitmapFormat.PNG);
}</code></pre>
<p><img src="https://images.gitee.com/uploads/images/2019/0121/182136_bba89ebf_1872936.png" alt="面积图" title="屏幕截图.png"></p>
<h2 id="饼状图"><a href="#饼状图" class="headerlink" title="饼状图"></a>饼状图</h2><pre><code class="java">@Test
public void generate() throws IOException {
    String filePath = &quot;C:\\Users\\user\\Desktop\\first.png&quot;;

    PieChart chart = new PieChartBuilder().width(800).height(600).title(getClass().getSimpleName()).build();

    // Customize Chart
    Color[] sliceColors = new Color[] { new Color(224, 68, 14), new Color(230, 105, 62), new Color(236, 143, 110), new Color(243, 180, 159), new Color(246, 199, 182) };
    chart.getStyler().setSeriesColors(sliceColors);

    // Series
    chart.addSeries(&quot;Gold&quot;, 24);
    chart.addSeries(&quot;Silver&quot;, 21);
    chart.addSeries(&quot;Platinum&quot;, 39);
    chart.addSeries(&quot;Copper&quot;, 17);
    chart.addSeries(&quot;Zinc&quot;, 40);

    BitmapEncoder.saveBitmap(chart, filePath, BitmapEncoder.BitmapFormat.PNG);
}</code></pre>
<p><img src="https://koral-home.oss-cn-beijing.aliyuncs.com/bignzhuang.png" alt="饼状图"></p>
<h2 id="散点图"><a href="#散点图" class="headerlink" title="散点图"></a>散点图</h2><pre><code class="java">@Test
public void generate() throws IOException {
    String filePath = &quot;C:\\Users\\user\\Desktop\\first.png&quot;;

    // Create Chart
    XYChart chart = new XYChartBuilder().width(800).height(600).build();

    // Customize Chart
    chart.getStyler().setDefaultSeriesRenderStyle(XYSeries.XYSeriesRenderStyle.Scatter);
    chart.getStyler().setChartTitleVisible(false);
    chart.getStyler().setLegendPosition(Styler.LegendPosition.InsideSW);
    chart.getStyler().setMarkerSize(16);

    // Series
    List&lt;Double&gt; xData = new LinkedList&lt;Double&gt;();
    List&lt;Double&gt; yData = new LinkedList&lt;Double&gt;();
    Random random = new Random();
    int size = 1000;
    for (int i = 0; i &lt; size; i++) {
        xData.add(random.nextGaussian() / 1000);
        yData.add(-1000000 + random.nextGaussian());
    }
    chart.addSeries(&quot;Gaussian Blob&quot;, xData, yData);


    BitmapEncoder.saveBitmap(chart, filePath, BitmapEncoder.BitmapFormat.PNG);
}</code></pre>
<p><img src="https://koral-home.oss-cn-beijing.aliyuncs.com/sandian.png" alt="散点图"></p>
<h2 id="柱状图"><a href="#柱状图" class="headerlink" title="柱状图"></a>柱状图</h2><pre><code class="java">@Test
public void generate() throws IOException {
    String filePath = &quot;C:\\Users\\user\\Desktop\\first.png&quot;;

    // Create Chart
    CategoryChart chart = new CategoryChartBuilder().width(800).height(600).title(&quot;Score Histogram&quot;).xAxisTitle(&quot;Score&quot;).yAxisTitle(&quot;Number&quot;).build();

    // Customize Chart
    chart.getStyler().setLegendPosition(Styler.LegendPosition.InsideNW);
    chart.getStyler().setHasAnnotations(true);

    // Series
    chart.addSeries(&quot;test 1&quot;, Arrays.asList(0, 1, 2, 3, 4), Arrays.asList(4, 5, 9, 6, 5));

    BitmapEncoder.saveBitmap(chart, filePath, BitmapEncoder.BitmapFormat.PNG);
}</code></pre>
<p><img src="https://koral-home.oss-cn-beijing.aliyuncs.com/zhuzhuang.png" alt="柱状图"></p>
<h2 id="堆叠图"><a href="#堆叠图" class="headerlink" title="堆叠图"></a>堆叠图</h2><pre><code class="java">@Test
public void generate() throws IOException {
    String filePath = &quot;C:\\Users\\user\\Desktop\\first.png&quot;;

    // Create Chart
    CategoryChart chart = new CategoryChartBuilder().width(800).height(600).title(&quot;Score Histogram&quot;).xAxisTitle(&quot;Mean&quot;).yAxisTitle(&quot;Count&quot;).build();

    // Customize Chart
    chart.getStyler().setLegendPosition(Styler.LegendPosition.InsideNW);
    chart.getStyler().setAvailableSpaceFill(.96);
    chart.getStyler().setOverlapped(true);

    // Series
    Histogram histogram1 = new Histogram(getGaussianData(10000), 20, -20, 20);
    Histogram histogram2 = new Histogram(getGaussianData(5000), 20, -20, 20);
    chart.addSeries(&quot;histogram 1&quot;, histogram1.getxAxisData(), histogram1.getyAxisData());
    chart.addSeries(&quot;histogram 2&quot;, histogram2.getxAxisData(), histogram2.getyAxisData());

    BitmapEncoder.saveBitmap(chart, filePath, BitmapEncoder.BitmapFormat.PNG);
}

private List&lt;Double&gt; getGaussianData(int count) {
    List&lt;Double&gt; data = new ArrayList&lt;Double&gt;(count);
    Random r = new Random();
    for (int i = 0; i &lt; count; i++) {
        data.add(r.nextGaussian() * 10);
    }
    return data;
}</code></pre>
<p><img src="https://koral-home.oss-cn-beijing.aliyuncs.com/duidie.png" alt="堆叠图"></p>
<h2 id="百分比堆叠柱状图"><a href="#百分比堆叠柱状图" class="headerlink" title="百分比堆叠柱状图"></a>百分比堆叠柱状图</h2><p>这个其实是堆叠图的变种。</p>
<pre><code class="java">@Test
public void generate() throws IOException {
    String filePath = &quot;C:\\Users\\user\\Desktop\\first.png&quot;;

    CategoryChart chart = new CategoryChartBuilder().width(800).height(600).build();
    chart.getStyler().setChartBackgroundColor(Color.WHITE);
    chart.getStyler().setLegendBorderColor(Color.WHITE);
    chart.getStyler().setLegendPosition(Styler.LegendPosition.InsideNW);
    chart.getStyler().setAvailableSpaceFill(0.7);
    chart.getStyler().setStacked(true);

    List&lt;String&gt; xData = Arrays.asList(&quot;学院A&quot;, &quot;学院B&quot;, &quot;学院C&quot;,&quot;学院D&quot;,&quot;学院E&quot;);

    chart.addSeries(&quot;得分A&quot;, xData, getGaussianData(5));
    chart.addSeries(&quot;得分B&quot;, xData, getGaussianData(5));
    chart.addSeries(&quot;得分C&quot;, xData, getGaussianData(5));
    chart.addSeries(&quot;得分D&quot;, xData, getGaussianData(5));

    BitmapEncoder.saveBitmap(chart, filePath, BitmapEncoder.BitmapFormat.PNG);
}

private List&lt;Double&gt; getGaussianData(int count) {
    List&lt;Double&gt; data = new ArrayList&lt;Double&gt;(count);
    for (int i = 0; i &lt; count; i++) {
        data.add(RandomUtils.nextDouble(0,1) * 10);
    }
    return data;
}</code></pre>
<p><img src="https://koral-home.oss-cn-beijing.aliyuncs.com/baifenbi.png" alt="百分比堆叠柱状图"></p>
<p>参考：</p>
<p> (1) <a href="https://knowm.org/open-source/xchart/xchart-example-code/" target="_blank" rel="noopener">XChart Demo</a></p>
<p> (2) 自己</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">koral</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://luokaiii.github.io/2018/09/01/POI/POI生成Excel-图表生成/">http://luokaiii.github.io/2018/09/01/POI/POI生成Excel-图表生成/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://luokaiii.github.io">凯</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/POI/">POI</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/09/01/POI/POI生成Excel-表格抽象工具类/"><i class="fa fa-chevron-left">  </i><span>POI生成Excel工具类</span></a></div><div class="next-post pull-right"><a href="/2018/09/01/读书笔记/《SpringData》/MongoDB/Spring-Data-MongoDB（1）/"><span>SpringDataMongoDB(一)</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By koral</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>